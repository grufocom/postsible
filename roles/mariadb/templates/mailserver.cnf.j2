# {{ ansible_managed }}
# MariaDB Configuration for Postsible Mailserver

[mysqld]
# Bind to localhost only (security)
bind-address = {{ mariadb_bind_address }}

# Character Set
character-set-server = {{ mariadb_character_set }}
collation-server = {{ mariadb_collation }}

# Performance
max_connections = {{ mariadb_max_connections }}
innodb_buffer_pool_size = {{ mariadb_innodb_buffer_pool_size }}
innodb_log_file_size = {{ mariadb_innodb_log_file_size }}
query_cache_size = {{ mariadb_query_cache_size }}
query_cache_type = {{ mariadb_query_cache_type }}

# InnoDB Settings
innodb_file_per_table = 1
innodb_flush_log_at_trx_commit = 2
innodb_flush_method = O_DIRECT

# Security
skip-name-resolve = {{ 'ON' if mariadb_skip_name_resolve else 'OFF' }}

# Logging
slow_query_log = 1
slow_query_log_file = /var/log/mysql/slow-query.log
long_query_time = 2

# Binary Logging (optional, for replication/backup)
# log_bin = /var/log/mysql/mysql-bin.log
# expire_logs_days = 7
# max_binlog_size = 100M
