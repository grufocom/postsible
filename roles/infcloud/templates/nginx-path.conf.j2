# {{ ansible_managed }}
# InfCloud - Path-based Configuration
# This will be included in the main nginx vhost

location {{ infcloud_base_path }} {
    alias {{ infcloud_install_path }};
    index index.html;

    try_files $uri $uri/ {{ infcloud_base_path }}/index.html;

    # Cache static files
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Deny access to sensitive files
    location ~ /\. {
        deny all;
    }
}

# Optional: Separate contacts path (or use same /cal/ for both)
location /contacts {
    alias {{ infcloud_install_path }};
    index index.html;

    try_files $uri $uri/ /contacts/index.html;

    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
