; {{ ansible_managed }}
; PHP-FPM pool configuration for Postsible

[www]
; Pool user/group
user = {{ nginx_user }}
group = {{ nginx_group }}

; Socket configuration
listen = {{ nginx_php_fpm_socket }}
listen.owner = {{ nginx_user }}
listen.group = {{ nginx_group }}
listen.mode = 0660

; Process manager
pm = {{ nginx_php_fpm_pm }}
pm.max_children = {{ nginx_php_fpm_max_children }}
pm.start_servers = {{ nginx_php_fpm_start_servers }}
pm.min_spare_servers = {{ nginx_php_fpm_min_spare_servers }}
pm.max_spare_servers = {{ nginx_php_fpm_max_spare_servers }}
pm.max_requests = 500

; Logging
php_admin_value[error_log] = /var/log/php{{ nginx_php_version }}-fpm.log
php_admin_flag[log_errors] = on

; Security
php_admin_value[disable_functions] = exec,passthru,shell_exec,system,proc_open,popen
php_admin_value[open_basedir] = /var/www:/tmp:/var/lib/php/sessions

; Performance
php_value[max_execution_time] = 300
php_value[max_input_time] = 300
php_value[memory_limit] = 256M
php_value[post_max_size] = 50M
php_value[upload_max_filesize] = 50M

; Session
php_value[session.save_handler] = files
php_value[session.save_path] = /var/lib/php/sessions
php_value[session.gc_maxlifetime] = 1440

; Timezone
php_value[date.timezone] = Europe/Vienna
