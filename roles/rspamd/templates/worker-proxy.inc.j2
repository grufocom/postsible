# Rspamd proxy worker configuration
# Managed by Ansible - DO NOT EDIT MANUALLY

# Proxy bindet auf Port 11332 (Milter f√ºr Postfix)
bind_socket = "127.0.0.1:{{ rspamd_worker_proxy_port | default('11332') }}";

# Upstream zu Normal Worker (Port 11333)
upstream "local" {
  default = yes;
  self_scan = yes; # Enable self-scan
  hosts = "127.0.0.1:{{ rspamd_worker_normal_port | default('11333') }}";
}

# Milter configuration
milter = yes;
timeout = {{ rspamd_worker_proxy_timeout | default('120s') }};

# Number of proxy workers
count = {{ rspamd_worker_proxy_count | default('2') }};

max_retries = 5; # How many times master is queried in case of failure
discard_on_reject = false; # Discard message instead of rejection
quarantine_on_reject = false; # Tell MTA to quarantine rejected messages
spam_header = "X-Spam"; # Use the specific spam header
reject_message = "Spam message rejected"; # Use custom rejection message

