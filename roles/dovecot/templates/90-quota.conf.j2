# {{ ansible_managed }}
# Dovecot Quota configuration

{% if dovecot_quota_enabled %}
plugin {
  quota = maildir:User quota
  quota_rule = {{ dovecot_quota_rule }}
  quota_exceeded_message = Quota exceeded, please delete some emails.
  
  # Quota warnings
  quota_warning = storage={{ dovecot_quota_warning_percent }}%% quota-warning {{ dovecot_quota_warning_percent }} %u
  quota_warning2 = storage=95%% quota-warning 95 %u
}

service quota-warning {
  executable = script /usr/local/bin/quota-warning.sh
  user = vmail
  unix_listener quota-warning {
    user = vmail
  }
}
{% else %}
# Quota disabled
{% endif %}
